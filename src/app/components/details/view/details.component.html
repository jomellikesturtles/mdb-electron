<div id='isVideoAvailable' *ngIf='showVideo' id='target'
  style='background-color: black;width: 100%;height: calc(100vh - 50px);'>
  <!-- <video *ngIf="showVideo" src="https://www.radiantmediaplayer.com/media/bbb-360p.mp4 -->
  <!-- " id="videoPlayer" controls style="width: 100%;height:100%;"> -->
  <video *ngIf="showVideo" style="width:100%; height:100%;" poster="" controls preload="none" autoplay>
    <!-- <video *ngIf="showVideo" controlsList="nodownload" style="width:100%;height:100%;" poster="" controls preload="none"> -->
    <source [src]='streamLink' type="video/mp4">
    <!-- <source [src]='"http://"+streamLink' type="video/mp4"> -->
    <!-- <source src="http://localhost:3000/stream" type="video/mp4"> -->
    <!-- <source src="https://s3.eu-central-1.amazonaws.com/pipe.public.content/short.mp4" type="video/mp4"> -->
    <!-- <track label="English subtitles" kind="subtitles" srclang="en" src="assets/sample-subtitles.vtt" default> -->
  </video>
  <!-- </video> -->
</div>

<div
  [ngStyle]="{'background-image': 'linear-gradient(to bottom, rgba(245, 246, 252, 0.52), rgba(117, 19, 93, 0.73)), url(https://image.tmdb.org/t/p/original' + movieDetails.backgroundPath + ')'}"
  style='background-size: cover;background-repeat: no-repeat;background-position: center;
  background-attachment: fixed;'>
  <div style='padding-top: 70px; padding-bottom: 100px'>
    <div style="color:white; text-shadow: 3px 3px 5px black;">
      <div class="container">

        <div class="row">
          <div class="col-sm-4" style='padding-left: 0px'>
            <div class='img-container'
              [ngStyle]="{'background-image':'url(https://image.tmdb.org/t/p/w342'+movieDetails.posterPath+')','height':'calc(1.481*300px)'}"
              style='background-size: cover; background-position: center; width: 100%; background-color: white;'>
            </div>

            <!-- <div class='img-container'
              [ngStyle]="{'background-image':'url('+movieDetails.posterPath+')','height':'calc(1.481*300px)'}"
              style='background-size: cover; background-position: center; width: 100%; background-color: white;'>
            </div> -->
            <div class='uk-button-group'>

              <button [disabled]='procBookmark' class='btn btn-small'
                [ngClass]="{'btn-success': !isBookmarked,'btn-danger':isBookmarked}" (click)='toggleBookmark()'>
                <span *ngIf="isBookmarked">Remove bookmark</span>
                <span *ngIf="!isBookmarked">Add bookmark</span>
              </button>

              <button [disabled]='procWatched' class='btn btn-small'
                [ngClass]="{'btn-success': !isWatched,'btn-danger':isWatched}" (click)='toggleWatched("100%")'>
                <span *ngIf="isWatched">Unmark as watched</span>
                <span *ngIf="!isWatched">Mark as watched</span>
              </button>

            </div>
          </div>
          <div class="col-sm-8">

            <h6>{{movieDetails.voteAverage}}</h6>
            <div style='display: flex;'>
              <h2 id="movie-title">{{movieDetails.original_title}}</h2>&nbsp;
              <h2 id="movie-title">{{movieDetails.title}}</h2>&nbsp;
              <h2 *ngIf="movieDetails.releaseDate" class='text-hyperlink'
                (click)='goToDiscover("year",getYear(movieDetails.releaseDate))'>
                ({{movieDetails.releaseDate|releaseYear}})
              </h2>
              <h2 (click)='goToDiscover("certification",movieCertification)'>{{movieCertification}}</h2>

              <button *ngIf="isVideoAvailable" class="btn btn-primary" type="button" (click)='playVideo()'
                [disabled]='procVideo || !isVideoAvailable'>
                <div *ngIf="procVideo">
                  <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                  Loading...
                </div>
                <div *ngIf="!procVideo">
                  <div *ngIf="isVideoAvailable">
                    Play
                  </div>
                  <div *ngIf="!isVideoAvailable">
                    Not available
                  </div>
                </div>
              </button>
              <button class='btn btn-primary' (click)='playTrailer()'>
                Play Trailer
              </button>
            </div>

            <!-- isVideoAvailable  -->
            <p id="movie-plot" style='overflow-wrap: break-word !important;
            word-wrap: break-word !important;
            white-space: pre-line;'>{{movieDetails.plot}}</p>

            <span class='text-hyperlink' (click)='goToDiscover("genre",item.id)'
              *ngFor="let item of movieDetails.genres; let isLast=last">
              {{item.name}}{{isLast ? '' : ', '}}
            </span>

            <p id="movie-runtime" class="">{{movieDetails.runtime|runtimeDisplay}}</p>
            <p *ngIf="movieDetailsDirectors">Directed by

              <span class='text-hyperlink' (click)='goToDiscover("person",director.id,director.name)'
                *ngFor="let director of movieDetailsDirectors; let isLast=last">
                {{director.name}}{{isLast ? '' : ', '}}
              </span>
            </p>

            <p *ngIf="movieDetailsWriters">Written by
              <span class='text-hyperlink' (click)='goToDiscover(writer.id)'
                *ngFor="let writer of movieDetailsWriters; let isLast=last">
                {{writer.name}}{{isLast ? '' : ', '}}
              </span>
            </p>
            <p *ngIf="movieDetailsProducers">Produced by
              <span class='text-hyperlink' (click)='goToDiscover(producer.id)'
                *ngFor="let producer of movieDetailsProducers; let isLast=last">
                {{producer.name}}{{isLast ? '' : ', '}}
              </span>
            </p>

            <div *ngIf="movieDetails.isAvailable">
            </div>
            <div>
              <!-- external links -->
              <div class='row'>
                <div class='customBtn' style='background-color:#f5de50;cursor: pointer' (click)="goToLink('imdb')">
                  <span class='icon' style='background: url(./assets/icons/imdb-logo.png);'></span>
                  <span class='buttonText'>Imdb</span>
                </div>
                <a (click)="goToLink('google')" style="cursor: pointer">Google</a>
                <div (click)="goToLink('tmdb')" data-toggle='tooltip' title='{{movieDetails.tmdbId}}'>
                  Tmdb
                </div>
                <div *ngIf="movieDetails.website" class='text-hyperlink' (click)="goToLink('website')"
                  data-toggle='tooltip' title='{{movieDetails.website}}'>
                  Website
                </div>
                <div *ngIf="movieDetails.external_ids" class='text-hyperlink'>
                  <div *ngIf="movieDetails.external_ids.facebook_id" class='text-hyperlink'
                    (click)="goToLink('facebook', movieDetails.external_ids.facebook_id)">
                    Facebook
                  </div>
                  <div *ngIf="movieDetails.external_ids.instagram_id" class='text-hyperlink'
                    (click)="goToLink('twitter', movieDetails.external_ids.instagram_id)">
                    Twitter
                  </div>
                  <div *ngIf="movieDetails.external_ids.twitter_id" class='text-hyperlink'
                    (click)="goToLink('instagram', movieDetails.external_ids.twitter_id)">
                    Instagram
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="movieDetails.isAvailable">

        </div>

        <div class="table-responsive-lg container">
          <table class="table">
            <thead>
            </thead>
            <tbody>
              <tr *ngFor="let torrent of torrents">
                <td>
                  <a [href]="sanitize(torrent)">{{torrent.name}}</a>
                </td>
                <td>
                </td>
                <td>
                  <p>{{torrent.seeds}}</p>
                </td>
                <td>
                  <p>{{torrent.peers}}</p>
                </td>
                <td>
                  <button class="btn btn-primary" (click)="copyToClipboard(torrent.magnet_link)">Copy to
                    clipboard</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class='container'>
        <div class="row">
          Cast
          <h5 class='text-hyperlink' (click)='goToFullCredits()'>See more...</h5>
          <div id='featuredCastAndCrewDisplay' class='d-inline-flex' style="overflow-y:hidden; overflow-x:auto;">
            <div *ngFor="let cast of movieDetails.credits.cast" style='margin-right: 20px;'>
              <div (click)='goToPerson(cast.id)' class='image-container'
                style='height: 200px; width: 185px; border-radius: 50%; cursor: pointer;'
                [ngStyle]="{'background-image': 'url(https://image.tmdb.org/t/p/w185'+cast.profile_path+')'}">
              </div>
              <div>
                <h6 class='text-hyperlink' (click)='goToPerson(cast.id)'>{{cast.name}}</h6>
                <p>{{cast.character}}</p>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          Recommended Movies
          <div id='recommendedMovies' class='d-inline-flex' style="overflow-y:hidden; overflow-x:auto;">
            <div *ngFor="let recommendedMovie of movieDetails.recommendations.results"
              style='margin-right: 8px; cursor: pointer;'>
              <div (click)='goToMovie(recommendedMovie.id)' class='image-container' style='height: 190px; width: 300px'
                [ngStyle]="{'background-image': 'url(https://image.tmdb.org/t/p/w300'+recommendedMovie.backdrop_path+')'}">
              </div>
              <div>
                <h6 (click)='goToMovie(recommendedMovie.id)' class='text-hyperlink'>{{recommendedMovie.title}}</h6>
                <!-- <label class='text-hyperlink' style='float: left'
                  (click)='goToDiscover("year",getYear(recommendedMovie.release_date))'>
                  {{recommendedMovie.release_date|releaseYear}}</label> -->
                <label class='text-hyperlink' style='float: left'
                  (click)='goToDiscover("year",getYear(recommendedMovie.release_date))'>
                  {{recommendedMovie.release_date|releaseYear}}</label>
                <label *ngIf='recommendedMovie.vote_average>0' style='float: right' data-toggle='tooltip'
                  title='{{recommendedMovie.vote_count}} votes'>
                  <img style='height:10px;
                filter: invert(1);margin-bottom: 4px;
                margin-right: 2px;' src='./assets/icons/star.svg' />{{recommendedMovie.vote_average}}</label>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- <div *ngIf="!hasData">
  <label>The movie you were looking for was not found.</label>
  <h1>No data retrieved :(</h1>
  <h3>{{troubleQuote.quote}}</h3>
  <h5>- {{troubleQuote.title}}</h5>
</div> -->
